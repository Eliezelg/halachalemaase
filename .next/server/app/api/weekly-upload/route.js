(()=>{var e={};e.id=467,e.ids=[467],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9748:e=>{"use strict";e.exports=require("fs/promises")},3873:e=>{"use strict";e.exports=require("path")},9672:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>c,serverHooks:()=>f,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>w});var s={};t.r(s),t.d(s,{POST:()=>d});var a=t(2706),o=t(8203),i=t(5994),n=t(9187),u=t(9748),p=t(3873),l=t.n(p);async function d(e){try{let r=await e.formData(),s=r.get("password"),a=r.get("file"),o=r.get("type");if("Lemaaseh"!==s)return n.NextResponse.json({error:"Mot de passe incorrect"},{status:401});if(!a)return n.NextResponse.json({error:"Aucun fichier fourni"},{status:400});if(!o||!["alon","gilion"].includes(o))return n.NextResponse.json({error:"Type de fichier invalide"},{status:400});let i=l().extname(a.name),p=`weekly-${o}${i}`,d=l().join(process.cwd(),"public","downloads",p),c=await a.arrayBuffer(),x=Buffer.from(c),w={[o]:{originalName:a.name,uploadDate:new Date().toISOString()}},f=l().join(process.cwd(),"public","downloads","metadata.json"),m={};try{let e=await Promise.resolve().then(t.t.bind(t,9748,23)).then(e=>e.readFile(f,"utf-8"));m=JSON.parse(e)}catch(e){}let h={...m,...w};await (0,u.writeFile)(f,JSON.stringify(h,null,2));try{await (0,u.unlink)(d)}catch(e){}return await (0,u.writeFile)(d,x),n.NextResponse.json({success:!0,message:`Fichier ${o} upload\xe9 avec succ\xe8s`,metadata:w[o]})}catch(e){return console.error("Erreur lors de l'upload:",e),n.NextResponse.json({error:"Erreur lors de l'upload du fichier"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/weekly-upload/route",pathname:"/api/weekly-upload",filename:"route",bundlePath:"app/api/weekly-upload/route"},resolvedPagePath:"D:\\Sites\\Halachalemaase\\halacha\\app\\api\\weekly-upload\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:w,serverHooks:f}=c;function m(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:w})}},6487:()=>{},8335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452],()=>t(9672));module.exports=s})();