(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7027],{5153:(e,s,t)=>{Promise.resolve().then(t.bind(t,4017))},4017:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var a=t(5155),l=t(2115);function r(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[n,c]=(0,l.useState)(""),[o,m]=(0,l.useState)(""),[x,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(null),[b,g]=(0,l.useState)(null),[j,N]=(0,l.useState)(!1),[f,v]=(0,l.useState)("");(0,l.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await fetch("/api/books"),t=await e.json();s(t.books)}catch(e){v("שגיאה בטעינת הספרים"),console.error("Error loading books:",e)}},w=async e=>{e.preventDefault(),N(!0),v("");try{let e=new FormData;if(e.append("title",t),e.append("description",i),e.append("price",n),e.append("nedarimPlusLink",o),e.append("isNew",x.toString()),h&&e.append("image",h),b&&e.append("id",b.id),!(await fetch("/api/books",{method:b?"PUT":"POST",body:e})).ok)throw Error("Failed to save book");r(""),d(""),c(""),m(""),u(!1),p(null),g(null),await y()}catch(e){v("שגיאה בשמירת הספר"),console.error("Error saving book:",e)}finally{N(!1)}},k=e=>{g(e),r(e.title),d(e.description),c(e.price.replace(/[^\d]/g,"")),m(e.nedarimPlusLink),u(e.isNew||!1)},S=async e=>{if(window.confirm("האם אתה בטוח שברצונך למחוק ספר זה?"))try{if(!(await fetch("/api/books?id=".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete book");await y()}catch(e){v("שגיאה במחיקת הספר"),console.error("Error deleting book:",e)}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"ניהול ספרי הרב"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:b?"עריכת ספר":"הוספת ספר חדש"}),f&&(0,a.jsx)("div",{className:"bg-red-50 text-red-500 p-3 rounded mb-4",children:f}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם הספר"}),(0,a.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded-md",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"תיאור"}),(0,a.jsx)("textarea",{value:i,onChange:e=>d(e.target.value),className:"w-full p-2 border rounded-md",rows:4,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מחיר (₪)"}),(0,a.jsx)("input",{type:"number",value:n,onChange:e=>c(e.target.value),className:"w-full p-2 border rounded-md",required:!0,min:"0",step:"0.01"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"קישור נדרים פלוס"}),(0,a.jsx)("input",{type:"url",value:o,onChange:e=>m(e.target.value),className:"w-full p-2 border rounded-md",placeholder:"https://nedar.im/..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"תמונת כריכה"}),(0,a.jsx)("input",{type:"file",onChange:e=>{var s;return p((null===(s=e.target.files)||void 0===s?void 0:s[0])||null)},className:"w-full p-2 border rounded-md",accept:"image/*",required:!b})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"isNew",checked:x,onChange:e=>u(e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"isNew",className:"mr-2 block text-sm text-gray-700",children:"סמן כספר חדש"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[b&&(0,a.jsx)("button",{type:"button",onClick:()=>{g(null),r(""),d(""),c(""),m(""),u(!1),p(null)},className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"ביטול"}),(0,a.jsx)("button",{type:"submit",disabled:j,className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 ".concat(j?"opacity-50 cursor-not-allowed":""),children:j?"שומר...":b?"עדכן ספר":"הוסף ספר"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"רשימת הספרים"}),(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[e.image&&(0,a.jsx)("img",{src:e.image,alt:e.title,className:"w-16 h-16 object-cover rounded"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.title}),e.isNew&&(0,a.jsx)("span",{className:"bg-burgundy-600 text-white px-2 py-0.5 rounded-full text-xs",children:"חדש"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.price}),e.nedarimPlusLink&&(0,a.jsx)("a",{href:e.nedarimPlusLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800",children:"קישור נדרים פלוס"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-800",children:"ערוך"}),(0,a.jsx)("button",{onClick:()=>S(e.id),className:"text-red-600 hover:text-red-800",children:"מחק"})]})]},e.id))})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8441,1517,7358],()=>s(5153)),_N_E=e.O()}]);